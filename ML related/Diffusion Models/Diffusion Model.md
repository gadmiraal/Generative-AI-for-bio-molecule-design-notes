## Basic concept

The following citation is from the original diffusion model paper [[Sohl-Dickstein, Jascha, et al. Deep Unsupervised Learning using Nonequilibrium Thermodynamics.pdf]] and gives a good description of the model 
	The essential idea is to systematically and slowly destroy structure in a data distribution through an iterative forward diffusion process. We then learn a reverse diffusion process that restores structure in data, yielding a highly flexible and tractable generative model of the data.

Meaning that we first gradually apply noise step-by-step to an image until the image itself becomes pure noise (forward diffusion process). We then train a Neural Network (NN) to remove this noise step-by-step until it is back to the original image (backwards diffusion process). If this NN is trained properly we can create new images, like the images it saw during training, from pure noise images. 
The reason why the backward phase is also done step-by-step is that estimating small perturbations is more tractable than explicitly describing the full distribution with a single, non-analytically-normalizable, potential function. 
## Forward Diffusion Process

In the forward step not the same amount of noise is applied at every step. This amount is regulated by a schedule which scales the mean and the variance down. This is done so that the variance does not explode overtime. The forward process is defined as $q(x_t|x_{t-1})$ where $x_t$ is the image with noise corresponding to time $t$. The forward process equals to $$q(x_t|x_{t-1}) = \mathcal{N}(x_t, \sqrt{1-\beta_t}x_{t-1},\beta_t I)$$Where $\beta_t \in [0,1]$ and is linked to the schedule. Using $\alpha_t = 1- \beta_t$ , $\bar{\alpha_t} = \prod^t_{s=1} \alpha_s$ and $\epsilon \sim \mathcal{N}(0,1)$ we can rewrite the previous equation to $$q(x_t|x_{t-1}) = \sqrt{\alpha_t}x_{t-1} + \sqrt{1-\alpha_t}\epsilon = \sqrt{\bar{\alpha_t}}x_{0} + \sqrt{1-\bar{\alpha_t}}\epsilon$$ 
#### Linear schedule
In the paper from [[Ho, Jonathan, et al. Denoising Diffusion Probabilistic Models.pdf]] they use a linear schedule for their mean and variance scaling. This could be considered sub-optimal since at around $80\%$ of the schedule the noise is already near pure noise. Additionally the information of the image can be destroyed to fast. For a visual reference see the figure below. 
#### Cosine schedule 
The cosine schedule destroys the information more slowly and is still informative at the end

![linear and cosine schedule](data:image/jpeg;base64,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)
*Figure 1. Result of using a linear schedule (top) and a cosine schedule(bottom) for mean and variance scaling*
## Backwards Diffusion Process

In the paper from [[Ho, Jonathan, et al. Denoising Diffusion Probabilistic Models.pdf]] they outlined three concepts the NN could predict at every step
1. The mean of the noise (in the beginning the variance of the noise is fixed so does not need to be predicted but later research also )
2. The original image 
3. The noise of the image (this could be used to subtract from the noisy image to end up with a less noisy image)
The second option wont work because of tractability issues. The first and third option come down to predicting the same thing.

The backwards process is defined as $$p(x_{t-1}|x_t)=\mathcal{N}(x_{t-1};\mu_\theta(x_t,t),\Sigma_\theta(x_t,t))$$Where $\mu_\theta$ and $\Sigma_\theta$ are NN that predict both the mean and the variance when given a noisy image $x_t$ and timestep $t$. 
#### Loss function
The loss of the model is the negative loglikelihood defined as $-\log(p_\theta(x_0))$. This is hard to do in practice since $x_0$ is dependent on all its predecessors. We can thus use a Variational Lower Bound (VLB) to find the loss which looks as follows $$-\log(p_\theta(x_0))\leq -\log(p_\theta(x_0))+ D_{KL}(q(x_{1:T}|x_0)||p_\theta(x_{1:T}|x_0))$$Which can be further rewritten to $$-\log(p_\theta(x_0))\leq \log(\frac{q(x_{1:T}|x_0)}{p_\theta(x_{0:T})})$$ With $$p_\theta(x_{0:T}) = p(x_T)\prod^T_{t=1}p_\theta(x_{t-1}|x_t)$$ 
Through even further simplification of this lower bound (which is left as an exercise to the reader 😈) and seeing that one only needs to predict the mean (given that the variance is fixed) which boils downs to only predicting the noise, results in the following very easy objective function$$L_{simple}=\mathbb{E}_{t,x_0,\epsilon}[||\epsilon-\epsilon_\theta(x_t,t)||^2]$$
During each loop in the backwards process the NN predicts at time step $t$ the amount of noise $\epsilon_t$ in $x_t$. We then subtract $\epsilon_t$ from $x_t$ to end up with an estimate $\hat{x}_0$. We then add $t-1$ amount of noise to our estimate $\hat{x}_0$ to get $x_{t-1}$. Which is then fed back into the NN until we arrive at $t=0$
## Architecture
[[Ho, Jonathan, et al. Denoising Diffusion Probabilistic Models.pdf]] designed their diffusion model architecture like a U-Net. This architecture has a bottle neck in the middle and has as input and output an image. It first down-sampled the input using down-sample and ResNet  blocks to a small resolution. It then project the down-sampled image back to its original size using up-sample blocks. At certain layers the authors used attention blocks and allowed for skip-connections between the down-sample and up-sample layers. 
The NN model is the same for every timestep but at every time step the sinusoidal embedding is projected onto each residual block. This is necessary because when using the cosine schedule the model must know the amount of noise it needs to remove since it is not the same for every timestep.

[[Dhariwal, Prafulla, et al. Diffusion Models Beat GANs on Image Synthesis.pdf]] slightly changed the architecture by increasing the depth, decreasing the width, added more attention layers and increased the amount of attention heads. Furthermore, the authors used the BigGAN residual blocks instead of the ResNet residual blocks. Additionally, they added Adaptive Group Normalization (AGN). 
AGN incorporates the timestep and the class label slightly different. This is done in each residual block after the first convolutional layer. A GroupNorm is applied which is multiplied with a linear projection of the timestep $y_s$ and a linear projection of the class label $y_b$ is added.$$AGN(h,y) = y_sGroupNorm(h)+y_b$$
Lastly, the authors added a [[Guidance in Diffusion Models]], which uses a separate classifier to help the diffusion model to generate specific classes
## Algorithms

***Algorithm 1 Training***
	1: **repeat**
	2: $x_0 \sim q(x_0)$
	3: $t\sim \mathcal{U}(\{1, \ldots, T\})$
	4: $\epsilon \sim \mathcal{N}(0,I)$
	5: Take the gradient descent step on: $\nabla_\theta ||\epsilon -\epsilon_\theta(\sqrt{\bar{\alpha_t}}x_{0} + \sqrt{1-\bar{\alpha_t}}\epsilon,t)||^2$ 
	6: **until** converged

***Algorithm 2 Sampling***
	1: $x_T\sim \mathcal{N}(0,I)$
	2: **for** $t=T, \ldots,1$ **do**
	3:    $z \sim \mathcal{N}(0,I)$ if $t > 1$, else $z=0$
	4:    $x_{t-1} = \frac{1}{\alpha_t}(x_t - \frac{1-\alpha_t}{\sqrt{1-\bar{\alpha_t}}}\epsilon_\theta(x_t,t))+\sigma_t z$   
	5: **end for**
	6: **return** $x_0$

## Variations and Extensions
- [[Guidance in Diffusion Models]]
- [[Equivariant Neural Network Models]] can be used in a diffusion setup to mitigate equivariant problems when predicting an output. 
- [[Wrapped Normal Diffusion Process]]
- [[Diffusion based Inpainting]]
- [[Stochastic Differential Equations]]
- [[Score-Based Generative Models]]

## Resources used
![](https://www.youtube.com/watch?v=HoKDTa5jHvg)